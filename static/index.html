<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>TestCafe remote worker</title>
</head>
<body>
<h1>TestCafe remote worker</h1>

<pre id="log">

</pre>

<script src="/socket.io/socket.io.js"></script>
<script>
  var log = document.getElementById('log');
  var socket = io.connect();
  socket.on('connect', function() {
    log.innerText += "Connected to hub, waiting for jobs...\n";
  });
  socket.on('reconnect', function() {
    log.innerText += "Rreconnected\n";
  });
  socket.on('connect_error', function(err) {
    log.innerText += "ConnectError:" + err.message + "\n";
  });
  socket.on('error', function(err) {
    log.innerText += "Error:" + err.message + "\n";
  });

  var openWindows = {};
  socket.on('run', function(data) {
    var url = data.url;
    log.innerText += "Testrun: " + url + "\n";;
    openWindows[url] = window.open(url);
  });
  socket.on('completed', function(data) {
    var url = data.url;
    log.innerText += "Completed: " + url + "\n";;
    openWindows[url].close();
    delete openWindows[url];
  });
</script>
</body>
</html>